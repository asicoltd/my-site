<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>24-Hour Color Grid Tracker</title>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<style>
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-family: system-ui, -apple-system, Segoe UI, sans-serif;
}

body {
    background: linear-gradient(135deg, #1a1a2e, #16213e);
    color: #f0f0f0;
    min-height: 100vh;
}

/* HEADER */
.header {
    position: sticky;
    top: 0;
    z-index: 10;
    background: rgba(26,26,46,0.95);
    backdrop-filter: blur(8px);
    padding: 14px;
    text-align: center;
}

.title {
    font-size: 1.7rem;
    font-weight: 700;
    background: linear-gradient(90deg, #6ee7b7, #3b82f6);
    background-clip: text;
    -webkit-background-clip: text;
    color: transparent;
}

.date-input {
    margin-top: 8px;
    background: rgba(255,255,255,0.1);
    border: none;
    color: #6ee7b7;
    padding: 8px 12px;
    border-radius: 8px;
    font-size: 1rem;
}

/* LAYOUT */
.container {
    padding: 16px;
    max-width: 1100px;
    margin: auto;
    display: flex;
    flex-direction: column;
    gap: 20px;
}

/* GRID */
.grid-container {
    background: rgba(255,255,255,0.05);
    padding: 16px;
    border-radius: 14px;
}

.hour-grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 10px;
}

.hour-cell {
    aspect-ratio: 1;
    border-radius: 10px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 600;
    font-size: 0.9rem;
    cursor: pointer;
}

.hour-cell.black { background: #1f2937; }
.hour-cell.green { background: #10b981; color: #fff; }
.hour-cell.yellow { background: #f59e0b; color: #1f2937; }
.hour-cell.red { background: #ef4444; color: #fff; }

.hour-cell:active {
    transform: scale(0.95);
}

/* CONTROLS */
.controls {
    display: flex;
    gap: 12px;
}

.btn {
    flex: 1;
    padding: 14px;
    border-radius: 12px;
    border: none;
    font-size: 1rem;
    font-weight: 600;
    color: white;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
    cursor: pointer;
}

.download-btn { background: #10b981; }
.reset-btn { background: #3b82f6; }

/* RESPONSIVE */
@media (min-width: 600px) {
    .hour-grid { grid-template-columns: repeat(6, 1fr); }
}
@media (min-width: 900px) {
    .hour-grid { grid-template-columns: repeat(12, 1fr); }
}

/* ===== DOWNLOAD CAPTURE ONLY ===== */
#captureOnly {
    position: fixed;
    left: -9999px;
    top: 0;
    background: #1a1a2e;
    padding: 20px;
    border-radius: 16px;
    width: 900px;
}

#captureDate {
    text-align: center;
    font-size: 1.6rem;
    font-weight: 700;
    color: #6ee7b7;
    margin-bottom: 16px;
}
</style>
</head>

<body>

<div class="header">
    <div class="title">24-Hour Color Grid Tracker</div>
    <input type="date" class="date-input" id="dateInput">
</div>

<div class="container">
    <div class="grid-container">
        <div class="hour-grid" id="hourGrid"></div>
    </div>

    <div class="controls">
        <button class="btn download-btn" id="downloadBtn">
            <i class="fas fa-download"></i> Download
        </button>
        <button class="btn reset-btn" id="resetBtn">
            <i class="fas fa-redo"></i> Reset
        </button>
    </div>
</div>

<!-- HIDDEN DOWNLOAD AREA -->
<div id="captureOnly">
    <div id="captureDate"></div>
    <div class="grid-container">
        <div class="hour-grid" id="captureGrid"></div>
    </div>
</div>

<script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>

<script>
document.addEventListener('DOMContentLoaded', () => {

    const dateInput = document.getElementById('dateInput');
    dateInput.valueAsDate = new Date();

    const states = ['black','green','yellow','red'];

    function createGrid(targetId) {
        const grid = document.getElementById(targetId);
        grid.innerHTML = '';

        for (let i = 0; i < 24; i++) {
            const cell = document.createElement('div');
            cell.className = 'hour-cell black';
            cell.dataset.state = '0';
            cell.textContent =
                i === 0 ? '12 AM' :
                i < 12 ? `${i} AM` :
                i === 12 ? '12 PM' :
                `${i - 12} PM`;

            cell.onclick = () => {
                let s = (parseInt(cell.dataset.state) + 1) % 4;
                cell.dataset.state = s;
                cell.className = 'hour-cell ' + states[s];
            };

            grid.appendChild(cell);
        }
    }

    function syncToCapture() {
        const mainCells = document.querySelectorAll('#hourGrid .hour-cell');
        const captureCells = document.querySelectorAll('#captureGrid .hour-cell');

        mainCells.forEach((cell, i) => {
            captureCells[i].className = cell.className;
        });

        document.getElementById('captureDate').textContent =
            new Date(dateInput.value).toDateString();
    }

    document.getElementById('resetBtn').onclick = () => {
        document.querySelectorAll('.hour-cell').forEach(c => {
            c.dataset.state = '0';
            c.className = 'hour-cell black';
        });
    };

    document.getElementById('downloadBtn').onclick = () => {
        syncToCapture();
        html2canvas(document.getElementById('captureOnly'), { scale: 2 })
        .then(canvas => {
            const link = document.createElement('a');
            link.download = `24-hour-grid-${dateInput.value}.png`;
            link.href = canvas.toDataURL();
            link.click();
        });
    };

    createGrid('hourGrid');
    createGrid('captureGrid');
});
</script>

</body>
</html>